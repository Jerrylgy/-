第四章  空间角度
4.1 概述
移动在空间中践行。移动分析的一个很重要的部分就是回答移动和包含移动的空间之间的关系。例如，在某个位置的不同时间内发生了多少次移动？不同地点的移动特征是什么样的，他们随着时间怎么样改变？不同地点直接通过移动建立起关系是怎么样的？不同地点的被访问顺序是怎么样的？为了回答以上问题，我们首先要获得我们感兴趣的地点集合，然后主要利用时间序列（Time Series）的方式处理移动数据。属性值的时间角度上的序列被叫做时间序列。描述空间地点或静态空间对象的时间序列就被叫做空间事件序列。
4.2 从移动数据获得感兴趣的位置
地理空间是连续的。然而，现实中我们不可能拥有一个连续空间中的所有位置的数据并对其进行分析。对于空间数据的展示和分析通常都是基于将空间当做离散的位置集合而来的。当某点的空间数据缺失时，我们有可能利用空间的连续性来对那个点的属性值进行估计和插补。
移动数据中，通常用坐标来表示一个连续空间中的空间位置。位置的集合是某个连续空间的地点的样本。通常来说，我们对处理这个样本中的每一个单独的地点不感兴趣。有两个原因。一是每个地点的数据量可能太少了，每个地点可能只被到达过一次或几次。二是样本地点的选择很多时候仅仅依赖于数据收集方式，例如每个多少时间间隔测量位置，而不是根据我们的分析目标或者地点的特征来选择样本中的地点。
因此，我们需要从原始的地点样本中抽取出我们感兴趣的地点来进行进一步的分析。除非说，我们事先指定好了我们对那些地点感兴趣，并在指定的地点收集数据。
有三种基本的抽取方法，空间细分，邻近地点分组，基于事件的地点抽取。
4.2.1 空间细分（space tessellation）
进行空间细分时，我们采用规则或者不规则的网格。在规则的网格中，每个格子在形状和大小上都是相等的。它的好处在于每个格子可以计算聚合特征，而这种计算没有受格子的大小所影响，因此我们可以对结果进行比较。它的劣处在于原始数据的空间分布可能是不均匀的，采用规则的划分则破幻了原始数据的空间分布。不规则细分致力于制造出大小上接近的格子，同时让这些格子与数据的空间分布相符。
空间细分的一个好处是连续空间的被全覆盖地处理了，没有遗漏任何存在的空间位置。
4.2.2 邻近地点分组
很多时候我们并不想要连续空间被全覆盖地处理，我们可能只想处理某片空间的一部分，这个时候空间细分技术就不适用了。这个时候我们采用邻近地点分组的方法。实现邻近地点分组，我们可以采用k-means或基于密度的聚类方法。
4.2.3 基于事件的地点抽取
当我们很关注空间事件发生的地点时，我们就可以采用基于事件的地点抽取。这些空间事件可以是例如停止，缓慢移动等个体移动事件，也可以是交通堵塞等集体移动事件。因此，我们首先要在移动数据集中抽取和构建相关事件，然后进行地点的抽取。
4.2.4 个人地点的抽取
在分析人的移动数据的时候，有时候我们必须抽取人的一些私人地点，例如家，工作地点等。我们可以先用基于事件的地点抽取。特殊之处在于，此时这些事件要有进行身份识别的主题属性。同时，我们要对这些事件进行聚类来找到事件重复发生的地方。对私人地点分析的非常重要的一个任务就是对这些地点进行语义上的解释，例如说将它们分为家庭，工作地点，购物地点等。
4.3 空间特征
我们通过对移动数据的离散时空聚合获得地点的特征。聚合的一个结果就是地点的时间序列集合。书中介绍了一些时间序列可视乎的不同方法。但鉴于许多难以理解，这里用一个图简单说明一下时间序列可视化的概念。更多更复杂的图应根据我们的分析实际需要进一步思考，选择或创造。

图5 空间角度Flicker用户可视化
例如上图是瑞士使用Flicker这个应用的用户，每月到访的地点的可视化。地图指示了用户所在的方位。而上方的红色圆圈所组成的柱子，则是由时间顺序所排列的，红色圆圈大小代表了用户量的多少。
4.4 空间关系
4.4.1 地点之间的双边连接分析
对象从A点到B点的移动就创造了一条A点到B点之间的连接。从A到B移动的对象越多，连接也就越多，相应的连接的强度也就越多。移动随着时间变化，这些连接的强度也随之变化。移动产生的地点之间的双边连接由移动者的时间序列，移动者的移动，根据时间序列而总结的移动特征（例如方向，平均速度）而塑造。一个对地点之间的双边连接分析的例图如下。数据集为米兰汽车数据集。
图6 米兰汽车移动连接可视化
图a代表了米兰城市中地点之间的移动情况。地点之间的移动次数越多，线条也就越粗。而图。而图b则是对时间序列数据分析其流动等级。横轴即为时间（间隔以小时计），纵轴为地点之间的流动次数。黑色粗线为所有地点之间的平均移动次数，而我们可以选择任意两点来观察其移动次数（即黑色的细线）与粗线进行对比。图c则是对时间序列数据分析其平均速度，解读方法类似c图。
4.4.2 频繁项集的发掘
当有很多我们感兴趣的地点时，我们可以通过序列挖掘算法来发现被到访地点的频繁发生序列。在序列挖掘算法中，移动者的轨迹被转换为被到访地点的标签序列。这些算法将数据当做符号序列处理并且返回频繁发生的子序列。之后，为了对空间情景中的结果进行解释和进一步探索，我们要将子集转换回轨迹。序列挖掘在对准连续数据的分析中的效果比对不定期移动数据的分析的效果好。

图7 Flicker用户频繁序列挖掘
如上图，对使用Flicker应用的用户的移动数据进行发掘。得到其被到访地点的频繁序列后然后转换为轨迹进行可视化表示。该图中颜色代表移动对象的数量。线条的粗细代表不同的轨迹数量。


